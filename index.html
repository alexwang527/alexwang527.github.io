<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>CSE 455 final project: Swing coach</title>

    <!-- Bootstrap core CSS -->
    <link href="css/bootstrap.css" rel="stylesheet">

    <!-- Add custom CSS here -->
    <link href="css/stylish-portfolio.css" rel="stylesheet">
    <link href="font-awesome/css/font-awesome.min.css" rel="stylesheet">
  </head>

  <body>

    <!-- Side Menu -->
    <a id="menu-toggle" href="#" class="btn btn-primary btn-lg toggle"><i class="fa fa-bars"></i></a>
    <div id="sidebar-wrapper">
      <ul class="sidebar-nav">
        <a id="menu-close" href="#" class="btn btn-default btn-lg pull-right toggle"><i class="fa fa-times"></i></a>
        <li><a href="#top">Home</a></li>
        <li><a href="#introduction">Introduction</a></li>
        <li><a href="#algorithm">Algorithm</a></li>
        <li><a href="#results">Results</a></li>
        <li><a href="#resources">Resources</a></li>
      </ul>
    </div>
    <!-- /Side Menu -->
  
    <!-- Full Page Image Header Area -->
    <div id="top" class="header">
      <div class="vert-text">
        <h1>Swing Coach</h1>
        <h3>CSE 455 final project by: Alex Wang</h3>
        <a href="#introduction" class="btn btn-default btn-lg">Learn More</a>
      </div>
    </div>
    <!-- /Full Page Image Header Area -->
  
    <!-- Intro -->
    <div id="introduction" class="intro">
      <div class="container">
        <div class="row">
          <div>
            <h2>Introduction</h2>
            <p> Devices that help golfers perfect their form are often expensive and 
              inaccessible. My project takes in images of a users swing at 4 key positions;
              setup, topswing, impact and finish then compares it with professional golfer
              Adam Scott's swing and returns a similarity score for each of the 4 key positions.
            </p>
          </div>
        </div>
      </div>
    </div>
    <!-- /Intro -->
  
    <!-- Algo -->
    <div id="algorithm" class="intro">
      <div class="container">
        <div class="row">
          <div>
            <h2>Algorithm</h2>
            <p> I used CMU's Openpose API for body part detection in images,
              the weights are from the pre-trained Caffe model, the file 
              "pose_iter_1600000.caffemodel" in my repository. This outputs a 4D
              matrix which includes a confidence map of each body part. Taking the global 
              maximums of each body part allows me to identify the location of the body parts
              I want. </p> <p>Afterwards we use the law of cosines to help us determine each angle in 
              a golfers pose, for example if we are trying to find the angle on the right elbow,
              we need the distances from a = right shoulder to right elbow, b = right elbow to right wrist and
              c = right wrist to right shoulder. 
              <code>c² = a² + b² - 2ab cos(C_ang)</code> we solve for C_ang to get the angle at the 
              right elbow. </p> <p> Once all the angles are calculated, I use the cosine similarites formula to calculate 
              a similarity score, let v1 be the set of angles in image1 and let v2 be the set of angles 
              in image2. The cosine similarity is computed with <code>  dot(v1, v2)/(norm(v1)*norm(v2)) </code>
              A score close to 0 indicates no similarity between the poses and a score close to 1 indicates the two poses are similar
            </p>
          </div>
        </div>
      </div>
    </div>
    <!-- /Algo -->

     <!-- Results -->
     <div id="results" class="intro">
      <div class="container">
        <div class="row">
          <div>
            <h2>Results</h2>
            <img src = "img/results.jpg"> 
            <p>The images on the top is the swing of an amatuer golfer and the images on the bottom 
              is the swing of a professional golfer.
            </p>
            <img src = "img/score.jpg"> 
            
          </div>
        </div>
      </div>
    </div>
    <!-- /Results -->



    <!-- Portfolio -->
    <div id="portfolio" class="portfolio">
      <div class="container">
        <div class="row">
          <div class="col-md-4 col-md-offset-4 text-center">
            <h2>Resources</h2>
            <hr>
          </div>
        </div>
      </div>
    </div>
    <!-- /Portfolio -->

    <!-- Footer -->
    <footer>
      <div class="container">
        <div class="row">
          <div class="col-md-6 col-md-offset-3 text-center">
            <ul class="list-inline">
              <li><i class="fa fa-facebook fa-3x"></i></li>
              <li><i class="fa fa-twitter fa-3x"></i></li>
              <li><i class="fa fa-dribbble fa-3x"></i></li>
            </ul>
            <div class="top-scroll">
              <a href="#top"><i class="fa fa-circle-arrow-up scroll fa-4x"></i></a>
            </div>
            <hr>
            <p>Copyright &copy; Alex Wang 2023</p>
          </div>
        </div>
      </div>
    </footer>
    <!-- /Footer -->

    <!-- JavaScript -->
    <script src="js/jquery-1.10.2.js"></script>
    <script src="js/bootstrap.js"></script>

    <!-- Custom JavaScript for the Side Menu and Smooth Scrolling -->
    <script>
        $("#menu-close").click(function(e) {
            e.preventDefault();
            $("#sidebar-wrapper").toggleClass("active");
        });
    </script>
    <script>
        $("#menu-toggle").click(function(e) {
            e.preventDefault();
            $("#sidebar-wrapper").toggleClass("active");
        });
    </script>
    <script>
      $(function() {
        $('a[href*=#]:not([href=#])').click(function() {
          if (location.pathname.replace(/^\//,'') == this.pathname.replace(/^\//,'') 
            || location.hostname == this.hostname) {

            var target = $(this.hash);
            target = target.length ? target : $('[name=' + this.hash.slice(1) +']');
            if (target.length) {
              $('html,body').animate({
                scrollTop: target.offset().top
              }, 1000);
              return false;
            }
          }
        });
      });
    </script>

  </body>

</html>